package org.example;

import com.beust.jcommander.JCommander;
import com.beust.jcommander.Parameter;

// 用于解析命令行中的参数
public class CmdArgs {
    @Parameter(names = {"-i", "--ip"}, description = "netcat listen & LDAPServer IP", required = true, order = 1)
    public static String ncIp = "0.0.0.0";
    @Parameter(names = {"-p", "--port"}, description = "listening port", required = true, order = 2)
    public static String ncPort = "7777";

    @Parameter(names = {"-u", "--url"}, description = "hacking url", required = true, order = 3)
    public static String targetURL;

    @Parameter(names = {"-h", "--help"}, help = true, description = "You can read the tool's usage")
    private static boolean helpInfo = false;


    public static void getArgs(String[] args) {
        JCommander jc = JCommander.newBuilder()
                .addObject(new CmdArgs())
                .build();
        System.out.println("\033[34;1m" + "\n" +
                "    __           __ __   _  ___    ______              __        _  __             \n" +
                "   / /   ____   / // /  (_)|__ \\  / ____/_  __ ____   / /____   (_)/ /_ ___   _____\n" +
                "  / /   / __ \\ / // /_ / / __/ / / __/  | |/_// __ \\ / // __ \\ / // __// _ \\ / ___/\n" +
                " / /___/ /_/ //__  __// / / __/ / /___ _>  < / /_/ // // /_/ // // /_ /  __// /    \n" +
                "/_____/\\____/   /_/__/ / /____//_____//_/|_|/ .___//_/ \\____//_/ \\__/ \\___//_/     \n" +
                "                  /___/                    /_/                                     \n" + "\033[0m");
        System.out.println("\t\t\t\t\t\t\t\t"+ "\033[34;1m" + "————created by 3xsh0re" + "\033[0m");
        System.out.println("\033[32;1m" + "[+]Log4j2Exploiter Running!" + "\033[0m");
        try{
            jc.parse(args);
        }catch(Exception e){
            if(!helpInfo){
                System.out.println("\033[31;1m" +"[-]Error: " + e.getMessage() + "\033[0m");
                helpInfo = true;
            }
        }

        if (helpInfo){
            System.out.println("\033[32;1m" +"[+]Log4j2Exploiter usage:" +
                    "\n\tuse this tool like: java8 -jar Log4j2Exploiter.jar " +
                    "-i 0.0.0.0 -p 7777 -u http://192.168.80.141:8983/solr/admin/cores?action=" + "\033[0m");
        }

    }

}
